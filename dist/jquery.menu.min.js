!function(t){var e={};t.registerDropDownMenuSkin=function(t,i){e[t]=i};function i(t,e){var i=e?"hover":"nohover",n=e?"nohover":"hover";t.hasClass(i)||t.addClass(i).removeClass(n)}function n(e,i){var n=[];return e.each(function(){!function t(e,i,n){if(1===e.nodeType&&!1!==i.call(e,e,n))for(var s=0,o=e.childNodes.length;s<o;s++)t(e.childNodes[s],i,n)}(this,i,n)}),t(n)}var s={showOnHover:!0,linksWithSubmenusEnabled:!1,navigateOnHoverPress:!0,selected:null,beforeShowPanel:null,beforeHidePanel:null,showPanelComplete:null,hidePanelComplete:null,animationShow:null,animationHide:null,position:null,skin:"basic"},o=function(e,n,s){t.proxyAll(this,"onPress","onPointerOver","onPointerOut","showComplete","hideComplete");var o=this;if(this.menu=e,this.options=this.menu.options,this.$panel=t(n),this.$item=s?t(s):this.$panel.closest(".menu-item"),this.$parentPanel=this.$item.closest(".menu-panel"),this.isTopLevel=0===this.$parentPanel.length,this.parent=null,this.children=[],this.isOpen=!1,this.transitioning=!1,this.$panel.length>0&&this.$panel.data("PanelInstance",this),this.$item.addClass("menu-item-with-submenu").on("press",this.onPress),this.options.showOnHover){var h=200;this.isTopLevel&&this.menu.siblings.length>0&&(h=function(){for(var t=0;t<o.menu.siblings.length;t++)for(var e=o.menu.siblings[t],i=0;i<e.rootMenu.children.length;i++){var n=e.rootMenu.children[i];if(n.isTopLevel&&n.isOpen)return 0}return 200}),this.$item.hoverDelay(this.onPointerOver,this.onPointerOut,{delayOver:h,delayOut:500})}this.isTopLevel&&this.$item.on("pointerout",function(e){if(!o.isOpen){if(e.relatedTarget&&t(this).has(e.relatedTarget).length>0&&!t(this).is(e.relatedTarget))return;i(o.$item,!1)}}),this.$panel.length>0&&(this.$panel.on("click",function(e){var i=t(e.target).closest(".menu-item",o.$panel);if(i&&!i.hasClass("menu-item-with-submenu")){var n=o.getEvent("selected",e);if(n.$selectedItem=i,n.selectedItem=i[0],o.options.selected&&o.options.selected.call(o,n,this),n.isDefaultPrevented())return void e.stopPropagation();if(!e.isDefaultPrevented())return;o.menu.hideAllPanels(e)}e.stopPropagation()}),this.options.linksWithSubmenusEnabled||this.getLinksWithSubmenus().on("click",function(t){t.preventDefault(),t.stopPropagation()}))};o.prototype.getLinksWithSubmenus=function(){return n(this.$item,function(e,i){return!t(e).hasClass("menu-panel")&&("A"==e.tagName&&i.push(e),!0)})},o.prototype.resolveParent=function(){this.parent=this.$parentPanel.data("PanelInstance")||this.menu.rootMenu,this.parent.children.push(this)},o.prototype.getEvent=function(e,i){return t.Event(e||"DropDownMenuPanelEvent",{$panel:this.$panel,panel:this,$parentPanel:this.$parentPanel,parentPanel:this.$parentPanel[0],$item:this.$item,item:this.$item[0],level:this.getLevel(),innerEvent:i})},o.prototype.getLevel=function(){if(!this._level){this._level=-1;for(var t=this.parent;t;)t=t.parent,this._level++}return this._level},o.prototype.getSiblings=function(){var e=this;if(!this._siblings){var i=[];this.parent&&t.each(this.parent.children,function(t,n){n!==e&&i.push(n)}),this._siblings=i}return this._siblings},o.prototype.shouldShowSubmenuOnHover=function(){return!this.isTopLevel||(this.menu.clickHoverActivated||this.options.showOnHover)},o.prototype.onPointerOver=function(t){this.isTopLevel&&i(this.$item,!0),this.shouldShowSubmenuOnHover()&&this.show(t)},o.prototype.onPointerOut=function(t){this.isTopLevel&&!this.options.showOnHover||this.shouldShowSubmenuOnHover()&&this.hide(t)},o.prototype.show=function(e){if(!this.transitioning&&!this.isOpen){if(this.$panel.length>0){var n=this.getEvent("beforeShowPanel",e);if(this.options.beforeShowPanel&&this.options.beforeShowPanel.call(this,n),n.isDefaultPrevented())return}t(document).trigger("ui.element.open",this),t.each(this.getSiblings(),function(t,i){i.hide(e)}),s=this.menu,o=e,t.each(l,function(t,e){s&&s===e||e.hideAllPanels(o)});var s,o;i(this.$item,!0),0!==this.$panel.length&&(this.transitioning=!0,this.options.position&&this.options.position.call(this,this.getEvent("position",e)),this.options.animationShow?this.options.animationShow.call(this,this.getEvent("animationShow",e),this.showComplete):(this.$panel.show(),this.showComplete()))}},o.prototype.showComplete=function(t){this.isOpen=!0,this.transitioning=!1,this.options.showPanelComplete&&this.options.showPanelComplete.call(this,this.getEvent(t))},o.prototype.hide=function(e){if(this.isOpen&&!this.transitioning){if(this.$panel.length>0){var n=this.getEvent(e);if(this.options.beforeHidePanel&&this.options.beforeHidePanel.call(this,n),n.isDefaultPrevented())return}i(this.$item,!1),0!==this.$panel.length&&(this.transitioning=!0,t.each(this.children,function(t,i){i.hide(e)}),this.options.animationHide?this.options.animationHide.call(this,this.getEvent(e),this.hideComplete):(this.$panel.hide(),this.hideComplete()))}},o.prototype.hideComplete=function(t){this.isOpen=!1,this.transitioning=!1,this.options.hidePanelComplete&&this.options.hidePanelComplete.call(this,this.getEvent(t))},o.prototype.onPress=function(e){if(e.stopPropagation(),0!==this.$panel.length&&"mouse"!==e.pointerType){if(this.$panel.length>0){var i=t(e.target).closest(".menu-panel");if(i.length>0&&i[0]===this.$panel[0])return}this.options.navigateOnHoverPress&&this.isOpen||(e.preventDefault(),e.preventClick()),this.transitioning||(this.isTopLevel&&(this.menu.clickHoverActivated=!0),this[this.isOpen?"hide":"show"](e),this.isTopLevel&&(this.menu.ignoreDocumentClick=+new Date))}},o.prototype.forceHide=function(t){this.menu.clickHoverActivated=!1,this.hide(t)};var h=function(e,n){var s=this;this.options=n,this.$topLevelItems=e.addClass("menu-item-top"),this.panels=[],this.siblings=this.options.siblings.map(function(e,i){return t(i).data("dropDownMenu")}),this.rootMenu={parent:null,children:[]},this.clickHoverActivated=!1,this.ignoreDocumentClick=!1,this.$topLevelItems.find(".menu-panel").each(function(t,e){s.panels.push(new o(s,e))}),this.$topLevelItems.not(".menu-item-with-submenu").each(function(t,e){s.panels.push(new o(s,null,e))}),t.each(this.panels,function(t,e){e.resolveParent()}),this.$topLevelItems.find(".menu-item").hoverDelay(function(){i(t(this),!0)},function(){i(t(this),!1)}).each(function(){i(t(this),!1)}),t(document).on("click",t.proxy(this.onDocumentClick,this))};h.prototype.hideAllPanels=function(e){this.ignoreDocumentClick=+new Date,t.each(this.rootMenu.children,function(t,i){i.forceHide(e)})},h.prototype.onDocumentClick=function(t){if(this.ignoreDocumentClick){var e=+new Date-this.ignoreDocumentClick;if(this.ignoreDocumentClick=!1,e<200)return}this.hideAllPanels(t)},t.fn.dropDownMenu=function(i){if(0===this.length)return this;var o=e[i.skin];if(!o)throw new Error("Invalid dropDownMenu skin: "+i.skin);var r=t.extend({},s,o||{},i);r.showOnHover||(r.linksWithSubmenusEnabled=!1);var a=t(this);return this.each(function(){var e=n(t(this),function(e,i){return!t(e).hasClass("menu-item")||(i.push(e),!1)}),i=new h(e,t.extend({},r,{siblings:a.not(this)}));t(this).data("dropDownMenu",i),l.push(i)}),this};var l=[]}(jQuery);