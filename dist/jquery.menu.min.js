!function(a){function b(a,b){var c=b?"hover":"nohover",d=b?"nohover":"hover";a.hasClass(c)||a.addClass(c).removeClass(d)}function c(a,b,d){if(1===a.nodeType&&b.call(a,a,d)!==!1)for(var e=0,f=a.childNodes.length;f>e;e++)c(a.childNodes[e],b,d)}function d(b,d){var e=[];return b.each(function(){c(this,d,e)}),a(e)}function e(b,c){a.each(j,function(a,d){b&&b===d||d.hideAllPanels(c)})}var f={};a.registerDropDownMenuSkin=function(a,b){f[a]=b};var g={showOnHover:!0,linksWithSubmenusEnabled:!1,selected:null,beforeShowPanel:null,beforeHidePanel:null,showPanelComplete:null,hidePanelComplete:null,animationShow:null,animationHide:null,position:null,skin:"basic"},h=function(c,d,e){a.proxyAll(this,"onPress","onClick","onPointerOver","onPointerOut","showComplete","hideComplete");var f=this;if(this.menu=c,this.options=this.menu.options,this.$panel=a(d),this.$item=e?a(e):this.$panel.closest(".menu-item"),this.$parentPanel=this.$item.closest(".menu-panel"),this.isTopLevel=0===this.$parentPanel.length,this.parent=null,this.children=[],this.isOpen=!1,this.transitioning=!1,this.$panel.length>0&&this.$panel.data("PanelInstance",this),this.shouldPreventNextClick=!1,this.$item.addClass("menu-item-with-submenu").on({press:this.onPress,click:this.onClick}),this.options.showOnHover){var g=200;this.isTopLevel&&this.menu.siblings.length>0&&(g=function(){for(var a=0;a<f.menu.siblings.length;a++)for(var b=f.menu.siblings[a],c=0;c<b.rootMenu.children.length;c++){var d=b.rootMenu.children[c];if(d.isTopLevel&&d.isOpen)return 0}return 200}),this.$item.hoverDelay(this.onPointerOver,this.onPointerOut,{delayOver:g,delayOut:500})}this.isTopLevel&&this.$item.on("pointerout",function(c){if(!f.isOpen){if(c.relatedTarget&&a(this).has(c.relatedTarget).length>0&&!a(this).is(c.relatedTarget))return;b(f.$item,!1)}}),this.$panel.length>0&&(this.$panel.on("click",function(b){var c=a(b.target).closest(".menu-item",f.$panel);if(c&&!c.hasClass("menu-item-with-submenu")){var d=f.getEvent("selected",b);if(d.$selectedItem=c,d.selectedItem=c[0],f.options.selected&&f.options.selected.call(f,d,this),d.isDefaultPrevented())return void b.stopPropagation();if(!b.isDefaultPrevented())return;f.menu.hideAllPanels(b)}b.stopPropagation()}),this.options.linksWithSubmenusEnabled||this.getLinksWithSubmenus().on("click",function(a){a.preventDefault(),a.stopPropagation()}))};h.prototype.getLinksWithSubmenus=function(){return d(this.$item,function(b,c){return a(b).hasClass("menu-panel")?!1:("A"==b.tagName&&c.push(b),!0)})},h.prototype.resolveParent=function(){this.parent=this.$parentPanel.data("PanelInstance")||this.menu.rootMenu,this.parent.children.push(this)},h.prototype.getEvent=function(b,c){return a.Event(b||"DropDownMenuPanelEvent",{$panel:this.$panel,panel:this,$parentPanel:this.$parentPanel,parentPanel:this.$parentPanel[0],$item:this.$item,item:this.$item[0],level:this.getLevel(),innerEvent:c})},h.prototype.getLevel=function(){if(!this._level){this._level=-1;for(var a=this.parent;a;)a=a.parent,this._level++}return this._level},h.prototype.getSiblings=function(){var b=this;if(!this._siblings){var c=[];this.parent&&a.each(this.parent.children,function(a,d){d!==b&&c.push(d)}),this._siblings=c}return this._siblings},h.prototype.shouldShowSubmenuOnHover=function(){return this.isTopLevel?this.menu.clickHoverActivated||this.options.showOnHover:!0},h.prototype.onPointerOver=function(a){this.isTopLevel&&b(this.$item,!0),this.shouldShowSubmenuOnHover()&&this.show(a)},h.prototype.onPointerOut=function(a){(!this.isTopLevel||this.options.showOnHover)&&this.shouldShowSubmenuOnHover()&&this.hide(a)},h.prototype.show=function(c){if(!this.transitioning&&!this.isOpen){if(this.$panel.length>0){var d=this.getEvent("beforeShowPanel",c);if(this.options.beforeShowPanel&&this.options.beforeShowPanel.call(this,d),d.isDefaultPrevented())return}a(document).trigger("ui.element.open",this),a.each(this.getSiblings(),function(a,b){b.hide(c)}),e(this.menu,c),b(this.$item,!0),0!==this.$panel.length&&(this.transitioning=!0,this.options.position&&this.options.position.call(this,this.getEvent("position",c)),this.options.animationShow?this.options.animationShow.call(this,this.getEvent("animationShow",c),this.showComplete):(this.$panel.show(),this.showComplete()))}},h.prototype.showComplete=function(a){this.isOpen=!0,this.transitioning=!1,this.options.showPanelComplete&&this.options.showPanelComplete.call(this,this.getEvent(a))},h.prototype.hide=function(c){if(this.isOpen&&!this.transitioning){if(this.$panel.length>0){var d=this.getEvent(c);if(this.options.beforeHidePanel&&this.options.beforeHidePanel.call(this,d),d.isDefaultPrevented())return}b(this.$item,!1),0!==this.$panel.length&&(this.transitioning=!0,a.each(this.children,function(a,b){b.hide(c)}),this.options.animationHide?this.options.animationHide.call(this,this.getEvent(c),this.hideComplete):(this.$panel.hide(),this.hideComplete()))}},h.prototype.hideComplete=function(a){this.isOpen=!1,this.transitioning=!1,this.options.hidePanelComplete&&this.options.hidePanelComplete.call(this,this.getEvent(a))},h.prototype.onClick=function(a){if(a.stopPropagation(),this.shouldPreventNextClick){var b=+new Date-this.shouldPreventNextClick;this.shouldPreventNextClick=!1,1e3>b&&a.preventDefault()}},h.prototype.onPress=function(b){if(b.stopPropagation(),0!==this.$panel.length&&"mouse"!=b.pointerType){if(this.$panel.length>0){var c=a(b.target).closest(".menu-panel");if(c.length>0&&c[0]===this.$panel[0])return void(this.shouldPreventNextClick=!1)}this.shouldPreventNextClick=+new Date,b.preventDefault(),this.transitioning||(this.isTopLevel&&(this.menu.clickHoverActivated=!0),this[this.isOpen?"hide":"show"](b),this.isTopLevel&&(this.menu.ignoreDocumentClick=+new Date))}},h.prototype.forceHide=function(a){this.menu.clickHoverActivated=!1,this.hide(a)};var i=function(c,d){var e=this;this.options=d,this.$topLevelItems=c.addClass("menu-item-top"),this.panels=[],this.siblings=this.options.siblings.map(function(b,c){return a(c).data("dropDownMenu")}),this.rootMenu={parent:null,children:[]},this.clickHoverActivated=!1,this.ignoreDocumentClick=!1,this.$topLevelItems.find(".menu-panel").each(function(a,b){e.panels.push(new h(e,b))}),this.$topLevelItems.not(".menu-item-with-submenu").each(function(a,b){e.panels.push(new h(e,null,b))}),a.each(this.panels,function(a,b){b.resolveParent()}),this.$topLevelItems.find(".menu-item").hoverDelay(function(){b(a(this),!0)},function(){b(a(this),!1)}).each(function(){b(a(this),!1)}),a(document).on("click",a.proxy(this.onDocumentClick,this))};i.prototype.hideAllPanels=function(b){this.ignoreDocumentClick=+new Date,a.each(this.rootMenu.children,function(a,c){c.forceHide(b)})},i.prototype.onDocumentClick=function(a){if(this.ignoreDocumentClick){var b=+new Date-this.ignoreDocumentClick;if(this.ignoreDocumentClick=!1,200>b)return}this.hideAllPanels(a)},a.fn.dropDownMenu=function(b){if(0===this.length)return this;var c=f[b.skin];if(!c)throw new Error("Invalid dropDownMenu skin: "+b.skin);var e=a.extend({},g,c||{},b);e.showOnHover||(e.linksWithSubmenusEnabled=!1);var h=a(this);return this.each(function(){var b=d(a(this),function(b,c){return a(b).hasClass("menu-item")?(c.push(b),!1):!0}),c=new i(b,a.extend({},e,{siblings:h.not(this)}));a(this).data("dropDownMenu",c),j.push(c)}),this};var j=[]}(jQuery);