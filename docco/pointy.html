<!DOCTYPE html>  <html> <head>   <title>pointy.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="breakpoints.html">                 breakpoints.js               </a>                                           <a class="source" href="date-parse.html">                 date-parse.js               </a>                                           <a class="source" href="jquery.breakpoints.html">                 jquery.breakpoints.js               </a>                                           <a class="source" href="jquery.calcRestrainedPos.html">                 jquery.calcRestrainedPos.js               </a>                                           <a class="source" href="jquery.clientRect.html">                 jquery.clientRect.js               </a>                                           <a class="source" href="jquery.contentSize.html">                 jquery.contentSize.js               </a>                                           <a class="source" href="jquery.cookies.html">                 jquery.cookies.js               </a>                                           <a class="source" href="jquery.css.html">                 jquery.css.js               </a>                                           <a class="source" href="jquery.customEvent.html">                 jquery.customEvent.js               </a>                                           <a class="source" href="jquery.delimitedString.html">                 jquery.delimitedString.js               </a>                                           <a class="source" href="jquery.disableEvent.html">                 jquery.disableEvent.js               </a>                                           <a class="source" href="jquery.hostIframe.html">                 jquery.hostIframe.js               </a>                                           <a class="source" href="jquery.hoverDelay.html">                 jquery.hoverDelay.js               </a>                                           <a class="source" href="jquery.htmlEncode.html">                 jquery.htmlEncode.js               </a>                                           <a class="source" href="jquery.imageSize.html">                 jquery.imageSize.js               </a>                                           <a class="source" href="jquery.isVisibleKeyCode.html">                 jquery.isVisibleKeyCode.js               </a>                                           <a class="source" href="jquery.menu.html">                 jquery.menu.js               </a>                                           <a class="source" href="jquery-menu-exampleskin.html">                 jquery-menu-exampleskin.js               </a>                                           <a class="source" href="jquery.modalDialog.deviceFixes.html">                 jquery.modalDialog.deviceFixes.js               </a>                                           <a class="source" href="jquery.modalDialog.getSettings.html">                 jquery.modalDialog.getSettings.js               </a>                                           <a class="source" href="jquery.modalDialog.header.html">                 jquery.modalDialog.header.js               </a>                                           <a class="source" href="jquery.modalDialog.history.html">                 jquery.modalDialog.history.js               </a>                                           <a class="source" href="jquery.modalDialog.html">                 jquery.modalDialog.js               </a>                                           <a class="source" href="jquery.modalDialog.unobtrusive.html">                 jquery.modalDialog.unobtrusive.js               </a>                                           <a class="source" href="jquery.modalDialog.userAgent.html">                 jquery.modalDialog.userAgent.js               </a>                                           <a class="source" href="jquery.modalDialogContent.header.html">                 jquery.modalDialogContent.header.js               </a>                                           <a class="source" href="jquery.modalDialogContent.html">                 jquery.modalDialogContent.js               </a>                                           <a class="source" href="jquery.msAjax.html">                 jquery.msAjax.js               </a>                                           <a class="source" href="jquery.ns.html">                 jquery.ns.js               </a>                                           <a class="source" href="jquery.partialLoad.html">                 jquery.partialLoad.js               </a>                                           <a class="source" href="jquery.postMessage.html">                 jquery.postMessage.js               </a>                                           <a class="source" href="jquery.proxyAll.html">                 jquery.proxyAll.js               </a>                                           <a class="source" href="jquery.queryString.html">                 jquery.queryString.js               </a>                                           <a class="source" href="jquery.richTooltip.html">                 jquery.richTooltip.js               </a>                                           <a class="source" href="jquery.scrollAnchor.html">                 jquery.scrollAnchor.js               </a>                                           <a class="source" href="jquery.uncomment.html">                 jquery.uncomment.js               </a>                                           <a class="source" href="jquery.url.html">                 jquery.url.js               </a>                                           <a class="source" href="pointy.gestures.html">                 pointy.gestures.js               </a>                                           <a class="source" href="pointy.html">                 pointy.js               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs"><a href="../index.html">Home</a> | 
<a href="https://github.com/vistaprint/SkinnyJS/blob/master/js/pointy.js" target="_blank">View this file on Github</a>

<hr style="height: 1px; border:0; background-color:#4A525A">
             <h1>               pointy.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <p>Pointer Events polyfill for jQuery</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">$</span><span class="p">,</span> <span class="nb">window</span><span class="p">,</span> <span class="nb">document</span><span class="p">,</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>

    <span class="kd">var</span> <span class="nx">support</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">touch</span><span class="o">:</span> <span class="s2">&quot;ontouchend&quot;</span> <span class="k">in</span> <span class="nb">document</span><span class="p">,</span>
        <span class="nx">pointer</span><span class="o">:</span> <span class="o">!!</span> <span class="p">(</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">pointerEnabled</span> <span class="o">||</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">msPointerEnabled</span><span class="p">)</span>
    <span class="p">};</span>

    <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">support</span><span class="p">,</span> <span class="nx">support</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">triggerCustomEvent</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="nx">eventType</span><span class="p">,</span> <span class="nx">originalEvent</span><span class="p">)</span> <span class="p">{</span>
</pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>support for IE7-IE8</p>             </td>             <td class="code">               <div class="highlight"><pre>
        <span class="nx">originalEvent</span> <span class="o">=</span> <span class="nx">originalEvent</span> <span class="o">||</span> <span class="nb">window</span><span class="p">.</span><span class="nx">event</span><span class="p">;</span>

</pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Create a writable copy of the event object and normalize some properties</p>             </td>             <td class="code">               <div class="highlight"><pre>
        <span class="kd">var</span> <span class="nx">event</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">Event</span><span class="p">(</span><span class="nx">originalEvent</span><span class="p">);</span>
        <span class="nx">event</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="nx">eventType</span><span class="p">;</span>

</pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Copy over properties for ease of access</p>             </td>             <td class="code">               <div class="highlight"><pre>
        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">copy</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">pointerHooks</span><span class="p">.</span><span class="nx">props</span><span class="p">);</span>
        <span class="nx">i</span> <span class="o">=</span> <span class="nx">copy</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">prop</span> <span class="o">=</span> <span class="nx">copy</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="nx">event</span><span class="p">[</span><span class="nx">prop</span><span class="p">]</span> <span class="o">=</span> <span class="nx">originalEvent</span><span class="p">[</span><span class="nx">prop</span><span class="p">];</span>
        <span class="p">}</span>

</pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>Support: IE&lt;9
Fix target property (#1925)</p>             </td>             <td class="code">               <div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">event</span><span class="p">.</span><span class="nx">target</span> <span class="o">=</span> <span class="nx">originalEvent</span><span class="p">.</span><span class="nx">srcElement</span> <span class="o">||</span> <span class="nb">document</span><span class="p">;</span>
        <span class="p">}</span>

</pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Support: Chrome 23+, Safari?
Target should not be a text node (#504, #13143)</p>             </td>             <td class="code">               <div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">===</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">event</span><span class="p">.</span><span class="nx">target</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">;</span>
        <span class="p">}</span>

</pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>Support: IE&lt;9
For mouse/key events, metaKey==false if it's undefined (#3368, #11328)</p>             </td>             <td class="code">               <div class="highlight"><pre>
        <span class="nx">event</span><span class="p">.</span><span class="nx">metaKey</span> <span class="o">=</span> <span class="o">!!</span> <span class="nx">event</span><span class="p">.</span><span class="nx">metaKey</span><span class="p">;</span>

</pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>run the filter now</p>             </td>             <td class="code">               <div class="highlight"><pre>
        <span class="nx">event</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">pointerHooks</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">originalEvent</span><span class="p">);</span>

</pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>trigger the emulated pointer event
the filter can return an array (only if the original was a touchmove),
which means we need to trigger independent events</p>             </td>             <td class="code">               <div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">event</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="nx">ev</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="nx">event</span><span class="p">);</span>
        <span class="p">}</span>

</pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>return the manipulated jQuery event</p>             </td>             <td class="code">               <div class="highlight"><pre>
        <span class="k">return</span> <span class="nx">event</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">addEvent</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="nx">type</span><span class="p">,</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">func</span><span class="p">)</span> <span class="p">{</span>
</pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>when we have a selector, let jQuery do the delegation</p>             </td>             <td class="code">               <div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="nx">selector</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">func</span><span class="p">.</span><span class="nx">_pointerEventWrapper</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">func</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="nx">event</span><span class="p">.</span><span class="nx">originalEvent</span><span class="p">);</span>
            <span class="p">};</span>

            <span class="nx">$</span><span class="p">(</span><span class="nx">elem</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">func</span><span class="p">.</span><span class="nx">_pointerEventWrapper</span><span class="p">);</span>
        <span class="p">}</span>

</pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>if we do not have a selector, we optimize by cutting jQuery out</p>             </td>             <td class="code">               <div class="highlight"><pre>
        <span class="k">else</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">elem</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">elem</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">func</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">elem</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">)</span> <span class="p">{</span>

</pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>bind the function to correct "this" for IE8-</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="nx">func</span><span class="p">.</span><span class="nx">_pointerEventWrapper</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="nx">func</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="nx">e</span><span class="p">);</span>
                <span class="p">};</span>

                <span class="nx">elem</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">(</span><span class="s2">&quot;on&quot;</span> <span class="o">+</span> <span class="nx">type</span><span class="p">,</span> <span class="nx">func</span><span class="p">.</span><span class="nx">_pointerEventWrapper</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">removeEvent</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="nx">type</span><span class="p">,</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">func</span><span class="p">)</span> <span class="p">{</span>
</pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>Make sure for IE8- we unbind the wrapper</p>             </td>             <td class="code">               <div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="nx">func</span><span class="p">.</span><span class="nx">_pointerEventWrapper</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">func</span> <span class="o">=</span> <span class="nx">func</span><span class="p">.</span><span class="nx">_pointerEventWrapper</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">selector</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">$</span><span class="p">(</span><span class="nx">elem</span><span class="p">).</span><span class="nx">off</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">func</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">$</span><span class="p">.</span><span class="nx">removeEvent</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="nx">type</span><span class="p">,</span> <span class="nx">func</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

</pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>get the standardized "buttons" property as per the Pointer Events spec from a mouse event</p>             </td>             <td class="code">               <div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">getStandardizedButtonsProperty</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
</pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>in the DOM LEVEL 3 spec there is a new standard for the "buttons" property
sadly, no browser currently supports this and only sends us the single "button" property</p>             </td>             <td class="code">               <div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">buttons</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">event</span><span class="p">.</span><span class="nx">buttons</span><span class="p">;</span>
        <span class="p">}</span>

</pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>standardize "which" property for use</p>             </td>             <td class="code">               <div class="highlight"><pre>
        <span class="kd">var</span> <span class="nx">which</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">which</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">which</span> <span class="o">&amp;&amp;</span> <span class="nx">event</span><span class="p">.</span><span class="nx">button</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">which</span> <span class="o">=</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">button</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">button</span> <span class="o">&amp;</span> <span class="mi">2</span> <span class="o">?</span> <span class="mi">3</span> <span class="o">:</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">button</span> <span class="o">&amp;</span> <span class="mi">4</span> <span class="o">?</span> <span class="mi">2</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)));</span>
        <span class="p">}</span>

</pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>no button down (can happen on mousemove)</p>             </td>             <td class="code">               <div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="nx">which</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
</pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>left button</p>             </td>             <td class="code">               <div class="highlight"><pre>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">which</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
</pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>middle mouse</p>             </td>             <td class="code">               <div class="highlight"><pre>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">which</span> <span class="o">===</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="mi">4</span><span class="p">;</span>
        <span class="p">}</span>
</pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>right mouse</p>             </td>             <td class="code">               <div class="highlight"><pre>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">which</span> <span class="o">===</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="mi">2</span><span class="p">;</span>
        <span class="p">}</span>

</pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p>unknown?</p>             </td>             <td class="code">               <div class="highlight"><pre>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">returnFalse</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span> <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">returnTrue</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="kc">true</span><span class="p">;</span> <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">POINTER_TYPE_UNAVAILABLE</span> <span class="o">=</span> <span class="s2">&quot;unavailable&quot;</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">POINTER_TYPE_TOUCH</span> <span class="o">=</span> <span class="s2">&quot;touch&quot;</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">POINTER_TYPE_PEN</span> <span class="o">=</span> <span class="s2">&quot;pen&quot;</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">POINTER_TYPE_MOUSE</span> <span class="o">=</span> <span class="s2">&quot;mouse&quot;</span><span class="p">;</span>

</pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>indicator to mark whether touch events are in progress
when null, it means we have never received a touch event
when true, user is currently touching something
when false, user just released their finger (reset on mousedown if needed)</p>             </td>             <td class="code">               <div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">_touching</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

</pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p>bitmask to identify which buttons are currently down</p>             </td>             <td class="code">               <div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">_buttons</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

</pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>storage of the last seen touches provided by the native touch events spec</p>             </td>             <td class="code">               <div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">_lastTouches</span> <span class="o">=</span> <span class="p">[];</span>

</pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <p>------ NOTE: THIS IS UNUSED, WE DO NOT ASSIGN BUTTON ------
pointer events defines the "button" property as:
mouse move (no buttons down)                         -1
left mouse, touch contact and normal pen contact     0
middle mouse                                         1
right mouse, pen with barrel button pressed          2
x1 (back button on mouse)                            3
x2 (forward button on mouse)                         4
pen contact with eraser button pressed               5
------ NOTE: THIS IS UNUSED, WE DO NOT ASSIGN BUTTON ------</p>             </td>             <td class="code">               <div class="highlight"><pre>

</pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <p>pointer events defines the "buttons" property as:
mouse move (no buttons down)                         0
left mouse, touch contact, and normal pen contact    1
middle mouse                                         4
right mouse, pen contact with barrel button pressed  2
x1 (back) mouse                                      8
x2 (forward) mouse                                   16
pen contact with eraser button pressed               32</p>             </td>             <td class="code">               <div class="highlight"><pre>

</pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <p>add our own pointer event hook/filter</p>             </td>             <td class="code">               <div class="highlight"><pre>
    <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">pointerHooks</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">props</span><span class="o">:</span> <span class="s2">&quot;pointerType pointerId buttons clientX clientY relatedTarget fromElement offsetX offsetY pageX pageY screenX screenY toElement&quot;</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">),</span>
        <span class="nx">filter</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">original</span><span class="p">)</span> <span class="p">{</span>
</pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <p>Calculate pageX/Y if missing and clientX/Y available
this is just copied from jQuery's standard pageX/pageY fix</p>             </td>             <td class="code">               <div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">original</span><span class="p">.</span><span class="nx">touches</span> <span class="o">&amp;&amp;</span> <span class="nx">event</span><span class="p">.</span><span class="nx">pageX</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">original</span><span class="p">.</span><span class="nx">clientX</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">eventDoc</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">ownerDocument</span> <span class="o">||</span> <span class="nb">document</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">doc</span> <span class="o">=</span> <span class="nx">eventDoc</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">body</span> <span class="o">=</span> <span class="nx">eventDoc</span><span class="p">.</span><span class="nx">body</span><span class="p">;</span>

                <span class="nx">event</span><span class="p">.</span><span class="nx">pageX</span> <span class="o">=</span> <span class="nx">original</span><span class="p">.</span><span class="nx">clientX</span> <span class="o">+</span> <span class="p">(</span><span class="nx">doc</span> <span class="o">&amp;&amp;</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">scrollLeft</span> <span class="o">||</span> <span class="nx">body</span> <span class="o">&amp;&amp;</span> <span class="nx">body</span><span class="p">.</span><span class="nx">scrollLeft</span> <span class="o">||</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="nx">doc</span> <span class="o">&amp;&amp;</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">clientLeft</span> <span class="o">||</span> <span class="nx">body</span> <span class="o">&amp;&amp;</span> <span class="nx">body</span><span class="p">.</span><span class="nx">clientLeft</span> <span class="o">||</span> <span class="mi">0</span><span class="p">);</span>
                <span class="nx">event</span><span class="p">.</span><span class="nx">pageY</span> <span class="o">=</span> <span class="nx">original</span><span class="p">.</span><span class="nx">clientY</span> <span class="o">+</span> <span class="p">(</span><span class="nx">doc</span> <span class="o">&amp;&amp;</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">||</span> <span class="nx">body</span> <span class="o">&amp;&amp;</span> <span class="nx">body</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">||</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="nx">doc</span> <span class="o">&amp;&amp;</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">clientTop</span> <span class="o">||</span> <span class="nx">body</span> <span class="o">&amp;&amp;</span> <span class="nx">body</span><span class="p">.</span><span class="nx">clientTop</span> <span class="o">||</span> <span class="mi">0</span><span class="p">);</span>
            <span class="p">}</span>

</pre></div>             </td>           </tr>                               <tr id="section-30">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-30">&#182;</a>               </div>               <p>Add relatedTarget, if necessary
also copied from jQuery's standard event fix</p>             </td>             <td class="code">               <div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">event</span><span class="p">.</span><span class="nx">relatedTarget</span> <span class="o">&amp;&amp;</span> <span class="nx">original</span><span class="p">.</span><span class="nx">fromElement</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">event</span><span class="p">.</span><span class="nx">relatedTarget</span> <span class="o">=</span> <span class="nx">original</span><span class="p">.</span><span class="nx">fromElement</span> <span class="o">===</span> <span class="nx">event</span><span class="p">.</span><span class="nx">target</span> <span class="o">?</span> <span class="nx">original</span><span class="p">.</span><span class="nx">toElement</span> <span class="o">:</span> <span class="nx">original</span><span class="p">.</span><span class="nx">fromElement</span><span class="p">;</span>
            <span class="p">}</span>

</pre></div>             </td>           </tr>                               <tr id="section-31">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-31">&#182;</a>               </div>               <p>Add pointerType</p>             </td>             <td class="code">               <div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">event</span><span class="p">.</span><span class="nx">pointerType</span> <span class="o">||</span> <span class="k">typeof</span> <span class="nx">event</span><span class="p">.</span><span class="nx">pointerType</span> <span class="o">==</span> <span class="s2">&quot;number&quot;</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">pointerType</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">event</span><span class="p">.</span><span class="nx">pointerType</span> <span class="o">=</span> <span class="nx">POINTER_TYPE_TOUCH</span><span class="p">;</span>
                <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">pointerType</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">event</span><span class="p">.</span><span class="nx">pointerType</span> <span class="o">=</span> <span class="nx">POINTER_TYPE_PEN</span><span class="p">;</span>
                <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">pointerType</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">event</span><span class="p">.</span><span class="nx">pointerType</span> <span class="o">=</span> <span class="nx">POINTER_TYPE_MOUSE</span><span class="p">;</span>
                <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="sr">/^touch/i</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">original</span><span class="p">.</span><span class="nx">type</span><span class="p">))</span> <span class="p">{</span>
                    <span class="nx">event</span><span class="p">.</span><span class="nx">pointerType</span> <span class="o">=</span> <span class="nx">POINTER_TYPE_TOUCH</span><span class="p">;</span>
                    <span class="nx">event</span><span class="p">.</span><span class="nx">buttons</span> <span class="o">=</span> <span class="nx">original</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s2">&quot;touchend&quot;</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
                <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="sr">/^mouse/i</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">original</span><span class="p">.</span><span class="nx">type</span><span class="p">)</span> <span class="o">||</span> <span class="nx">original</span><span class="p">.</span><span class="nx">type</span> <span class="o">==</span> <span class="s2">&quot;click&quot;</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">event</span><span class="p">.</span><span class="nx">pointerId</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// as per the pointer events spec, the mouse is always pointer id 1</span>
                    <span class="nx">event</span><span class="p">.</span><span class="nx">pointerType</span> <span class="o">=</span> <span class="nx">POINTER_TYPE_MOUSE</span><span class="p">;</span>
                    <span class="nx">event</span><span class="p">.</span><span class="nx">buttons</span> <span class="o">=</span> <span class="nx">original</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s2">&quot;mouseup&quot;</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="nx">getStandardizedButtonsProperty</span><span class="p">(</span><span class="nx">original</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="nx">event</span><span class="p">.</span><span class="nx">pointerType</span> <span class="o">=</span> <span class="nx">POINTER_TYPE_UNAVAILABLE</span><span class="p">;</span>
                    <span class="nx">event</span><span class="p">.</span><span class="nx">buttons</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>

</pre></div>             </td>           </tr>                               <tr id="section-32">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-32">&#182;</a>               </div>               <p>if we have the bitmask for the depressed buttons from the mouse events polyfill, use it to mimic buttons for
browsers that do not support the HTML DOM LEVEL 3 events spec</p>             </td>             <td class="code">               <div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s2">&quot;pointermove&quot;</span> <span class="o">&amp;&amp;</span> <span class="nx">_touching</span> <span class="o">===</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">_buttons</span> <span class="o">!==</span> <span class="nx">event</span><span class="p">.</span><span class="nx">buttons</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">event</span><span class="p">.</span><span class="nx">buttons</span> <span class="o">=</span> <span class="nx">_buttons</span><span class="p">;</span>
            <span class="p">}</span>

</pre></div>             </td>           </tr>                               <tr id="section-33">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-33">&#182;</a>               </div>               <p>prevent the follow native click event from occurring, can be used to prevent
clicks on pointerdown or pointerup or from gestures like press and presshold</p>             </td>             <td class="code">               <div class="highlight"><pre>
            <span class="nx">event</span><span class="p">.</span><span class="nx">preventClick</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                <span class="nx">event</span><span class="p">.</span><span class="nx">isClickPrevented</span> <span class="o">=</span> <span class="nx">returnTrue</span><span class="p">;</span>
                <span class="nx">$</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">).</span><span class="nx">one</span><span class="p">(</span><span class="s2">&quot;click&quot;</span><span class="p">,</span> <span class="nx">returnFalse</span><span class="p">);</span>
            <span class="p">};</span>

            <span class="nx">event</span><span class="p">.</span><span class="nx">isClickPrevented</span> <span class="o">=</span> <span class="nx">returnFalse</span><span class="p">;</span>

</pre></div>             </td>           </tr>                               <tr id="section-34">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-34">&#182;</a>               </div>               <p>touch events send an array of touches we need to convert to the pointer events format
which means we need to fire multiple events per touch</p>             </td>             <td class="code">               <div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="nx">original</span><span class="p">.</span><span class="nx">touches</span> <span class="o">&amp;&amp;</span> <span class="nx">event</span><span class="p">.</span><span class="nx">type</span> <span class="o">!==</span> <span class="s2">&quot;pointercancel&quot;</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">touches</span> <span class="o">=</span> <span class="nx">original</span><span class="p">.</span><span class="nx">touches</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">events</span> <span class="o">=</span> <span class="p">[];</span>
                <span class="kd">var</span> <span class="nx">ev</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">;</span>

</pre></div>             </td>           </tr>                               <tr id="section-35">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-35">&#182;</a>               </div>               <p>the problem with this is that on touchend it will remove the
touch which has ended from the touches list, this means we do
not want to fire pointerup for touches that are still there,
we instead want to send a pointerup with the removed touch's identifier</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s2">&quot;pointerup&quot;</span><span class="p">)</span> <span class="p">{</span>
</pre></div>             </td>           </tr>                               <tr id="section-36">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-36">&#182;</a>               </div>               <p>convert TouchList to a standard array</p>             </td>             <td class="code">               <div class="highlight"><pre>
                    <span class="nx">_lastTouches</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">_lastTouches</span><span class="p">);</span>

</pre></div>             </td>           </tr>                               <tr id="section-37">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-37">&#182;</a>               </div>               <p>find the touch that was removed</p>             </td>             <td class="code">               <div class="highlight"><pre>
                    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">original</span><span class="p">.</span><span class="nx">touches</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">_lastTouches</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                            <span class="k">if</span> <span class="p">(</span><span class="nx">_lastTouches</span><span class="p">[</span><span class="nx">j</span><span class="p">].</span><span class="nx">identifier</span> <span class="o">===</span> <span class="nx">original</span><span class="p">.</span><span class="nx">touches</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">identifier</span><span class="p">)</span> <span class="p">{</span>
                                <span class="nx">_lastTouches</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">j</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>

</pre></div>             </td>           </tr>                               <tr id="section-38">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-38">&#182;</a>               </div>               <p>if we narrowed down the ended touch to one, then we found it</p>             </td>             <td class="code">               <div class="highlight"><pre>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">_lastTouches</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">event</span><span class="p">.</span><span class="nx">pointerId</span> <span class="o">=</span> <span class="nx">_lastTouches</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">identifier</span><span class="p">;</span>
                        <span class="nx">_lastTouches</span> <span class="o">=</span> <span class="nx">original</span><span class="p">.</span><span class="nx">touches</span><span class="p">;</span>
                        <span class="k">return</span> <span class="nx">event</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
</pre></div>             </td>           </tr>                               <tr id="section-39">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-39">&#182;</a>               </div>               <p>on pointerdown we need to only trigger a new pointerdown for the touch,
and not the touches that were already there</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s2">&quot;pointerdown&quot;</span><span class="p">)</span> <span class="p">{</span>
</pre></div>             </td>           </tr>                               <tr id="section-40">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-40">&#182;</a>               </div>               <p>convert TouchList to a standard array</p>             </td>             <td class="code">               <div class="highlight"><pre>
                    <span class="nx">touches</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">original</span><span class="p">.</span><span class="nx">touches</span><span class="p">);</span>

</pre></div>             </td>           </tr>                               <tr id="section-41">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-41">&#182;</a>               </div>               <p>find the new touch that was just added</p>             </td>             <td class="code">               <div class="highlight"><pre>
                    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">touches</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</pre></div>             </td>           </tr>                               <tr id="section-42">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-42">&#182;</a>               </div>               <p>last touches will be a list with one less touch</p>             </td>             <td class="code">               <div class="highlight"><pre>
                        <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">_lastTouches</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                            <span class="k">if</span> <span class="p">(</span><span class="nx">touches</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">identifier</span> <span class="o">===</span> <span class="nx">_lastTouches</span><span class="p">[</span><span class="nx">j</span><span class="p">].</span><span class="nx">identifier</span><span class="p">)</span> <span class="p">{</span>
                                <span class="nx">touches</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>

</pre></div>             </td>           </tr>                               <tr id="section-43">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-43">&#182;</a>               </div>               <p>this will be used on pointermove and pointerdown</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">original</span><span class="p">.</span><span class="nx">touches</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">touch</span> <span class="o">=</span> <span class="nx">original</span><span class="p">.</span><span class="nx">touches</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
                    <span class="nx">ev</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">({},</span> <span class="nx">event</span><span class="p">);</span>
</pre></div>             </td>           </tr>                               <tr id="section-44">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-44">&#182;</a>               </div>               <p>copy over information from the touch to the event</p>             </td>             <td class="code">               <div class="highlight"><pre>
                    <span class="nx">ev</span><span class="p">.</span><span class="nx">clientX</span> <span class="o">=</span> <span class="nx">touch</span><span class="p">.</span><span class="nx">clientX</span><span class="p">;</span>
                    <span class="nx">ev</span><span class="p">.</span><span class="nx">clientY</span> <span class="o">=</span> <span class="nx">touch</span><span class="p">.</span><span class="nx">clientY</span><span class="p">;</span>
                    <span class="nx">ev</span><span class="p">.</span><span class="nx">pageX</span> <span class="o">=</span> <span class="nx">touch</span><span class="p">.</span><span class="nx">pageX</span><span class="p">;</span>
                    <span class="nx">ev</span><span class="p">.</span><span class="nx">pageY</span> <span class="o">=</span> <span class="nx">touch</span><span class="p">.</span><span class="nx">pageY</span><span class="p">;</span>
                    <span class="nx">ev</span><span class="p">.</span><span class="nx">screenX</span> <span class="o">=</span> <span class="nx">touch</span><span class="p">.</span><span class="nx">screenX</span><span class="p">;</span>
                    <span class="nx">ev</span><span class="p">.</span><span class="nx">screenY</span> <span class="o">=</span> <span class="nx">touch</span><span class="p">.</span><span class="nx">screenY</span><span class="p">;</span>
</pre></div>             </td>           </tr>                               <tr id="section-45">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-45">&#182;</a>               </div>               <p>the touch id on emulated touch events from chrome is always 0 (zero)</p>             </td>             <td class="code">               <div class="highlight"><pre>
                    <span class="nx">ev</span><span class="p">.</span><span class="nx">pointerId</span> <span class="o">=</span> <span class="nx">touch</span><span class="p">.</span><span class="nx">identifier</span><span class="p">;</span>
                    <span class="nx">events</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">ev</span><span class="p">);</span>
                <span class="p">}</span>

</pre></div>             </td>           </tr>                               <tr id="section-46">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-46">&#182;</a>               </div>               <p>do as little processing as you can here, this is done on touchmove and
there can be a lot of those events firing quickly, we do not want the
polyfill slowing down the application</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="nx">_lastTouches</span> <span class="o">=</span> <span class="nx">original</span><span class="p">.</span><span class="nx">touches</span><span class="p">;</span>
                <span class="k">return</span> <span class="nx">events</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">return</span> <span class="nx">event</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">};</span>

    <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">delegateSpecial</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">setup</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">handleObj</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">thisObject</span> <span class="o">=</span> <span class="k">this</span><span class="p">,</span>
                <span class="nx">data</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="nx">thisObject</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">data</span><span class="p">.</span><span class="nx">pointerEvents</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">data</span><span class="p">.</span><span class="nx">pointerEvents</span> <span class="o">=</span> <span class="p">{};</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">data</span><span class="p">.</span><span class="nx">pointerEvents</span><span class="p">[</span><span class="nx">handleObj</span><span class="p">.</span><span class="nx">type</span><span class="p">])</span> <span class="p">{</span>
                <span class="nx">data</span><span class="p">.</span><span class="nx">pointerEvents</span><span class="p">[</span><span class="nx">handleObj</span><span class="p">.</span><span class="nx">type</span><span class="p">]</span> <span class="o">=</span> <span class="p">[];</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">data</span><span class="p">.</span><span class="nx">pointerEvents</span><span class="p">[</span><span class="nx">handleObj</span><span class="p">.</span><span class="nx">type</span><span class="p">].</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">setup</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">thisObject</span><span class="p">,</span> <span class="nx">handleObj</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">data</span><span class="p">.</span><span class="nx">pointerEvents</span><span class="p">[</span><span class="nx">handleObj</span><span class="p">.</span><span class="nx">type</span><span class="p">].</span><span class="nx">push</span><span class="p">(</span><span class="nx">handleObj</span><span class="p">);</span>
        <span class="p">};</span>
    <span class="p">};</span>

    <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">delegateSpecial</span><span class="p">.</span><span class="nx">remove</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">teardown</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">handleObj</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">handlers</span><span class="p">,</span>
                <span class="nx">thisObject</span> <span class="o">=</span> <span class="k">this</span><span class="p">,</span>
                <span class="nx">data</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="nx">thisObject</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">data</span><span class="p">.</span><span class="nx">pointerEvents</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">data</span><span class="p">.</span><span class="nx">pointerEvents</span> <span class="o">=</span> <span class="p">{};</span>
            <span class="p">}</span>

            <span class="nx">handlers</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">pointerEvents</span><span class="p">[</span><span class="nx">handleObj</span><span class="p">.</span><span class="nx">type</span><span class="p">];</span>

            <span class="nx">handlers</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">handlers</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">handleObj</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">handlers</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">teardown</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">thisObject</span><span class="p">,</span> <span class="nx">handleObj</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">};</span>
    <span class="p">};</span>

</pre></div>             </td>           </tr>                               <tr id="section-47">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-47">&#182;</a>               </div>               <p>allow jQuery's native $.event.fix to find our pointer hooks</p>             </td>             <td class="code">               <div class="highlight"><pre>
    <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">fixHooks</span><span class="p">,</span> <span class="p">{</span>
        <span class="nx">pointerdown</span><span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">pointerHooks</span><span class="p">,</span>
        <span class="nx">pointerup</span><span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">pointerHooks</span><span class="p">,</span>
        <span class="nx">pointermove</span><span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">pointerHooks</span><span class="p">,</span>
        <span class="nx">pointerover</span><span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">pointerHooks</span><span class="p">,</span>
        <span class="nx">pointerout</span><span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">pointerHooks</span><span class="p">,</span>
        <span class="nx">pointercancel</span><span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">pointerHooks</span>
    <span class="p">});</span>

</pre></div>             </td>           </tr>                               <tr id="section-48">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-48">&#182;</a>               </div>               <p>if browser does not natively handle pointer events,
create special custom events to mimic them</p>             </td>             <td class="code">               <div class="highlight"><pre>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">support</span><span class="p">.</span><span class="nx">pointer</span><span class="p">)</span> <span class="p">{</span>
</pre></div>             </td>           </tr>                               <tr id="section-49">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-49">&#182;</a>               </div>               <p>stores the scroll-y offest on touchstart and is compared
on touchend to see if we should trigger a click event</p>             </td>             <td class="code">               <div class="highlight"><pre>
        <span class="kd">var</span> <span class="nx">_startScrollOffset</span><span class="p">;</span>

</pre></div>             </td>           </tr>                               <tr id="section-50">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-50">&#182;</a>               </div>               <p>utility to return the scroll-y position</p>             </td>             <td class="code">               <div class="highlight"><pre>
        <span class="kd">var</span> <span class="nx">scrollY</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">scrollY</span> <span class="o">||</span> <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">scrollTop</span><span class="p">());</span>
        <span class="p">};</span>

        <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">special</span><span class="p">.</span><span class="nx">pointerdown</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nx">touch</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
</pre></div>             </td>           </tr>                               <tr id="section-51">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-51">&#182;</a>               </div>               <p>set the pointer as currently down to prevent chorded PointerDown events</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="nx">_touching</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

</pre></div>             </td>           </tr>                               <tr id="section-52">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-52">&#182;</a>               </div>               <p>trigger a new PointerDown event</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="nx">triggerCustomEvent</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">&quot;pointerdown&quot;</span><span class="p">,</span> <span class="nx">event</span><span class="p">);</span>

</pre></div>             </td>           </tr>                               <tr id="section-53">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-53">&#182;</a>               </div>               <p>set the scroll offset which is compared on TouchEnd</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="nx">_startScrollOffset</span> <span class="o">=</span> <span class="nx">scrollY</span><span class="p">();</span>
            <span class="p">},</span>
            <span class="nx">mouse</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
</pre></div>             </td>           </tr>                               <tr id="section-54">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-54">&#182;</a>               </div>               <p>if we just had a touchstart, ignore this MouseDown event, to prevent double firing of PointerDown</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="k">if</span> <span class="p">(</span><span class="nx">_touching</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">return</span><span class="p">;</span>
                <span class="p">}</span>

</pre></div>             </td>           </tr>                               <tr id="section-55">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-55">&#182;</a>               </div>               <p>we reset the touch to null, to indicate that we're listening to mouse events currently</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="nx">_touching</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

</pre></div>             </td>           </tr>                               <tr id="section-56">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-56">&#182;</a>               </div>               <p>update the _buttons bitmask</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="kd">var</span> <span class="nx">button</span> <span class="o">=</span> <span class="nx">getStandardizedButtonsProperty</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>
                <span class="kd">var</span> <span class="nx">wasAButtonDownAlready</span> <span class="o">=</span> <span class="nx">_buttons</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">;</span>
                <span class="nx">_buttons</span> <span class="o">|=</span> <span class="nx">button</span><span class="p">;</span>

</pre></div>             </td>           </tr>                               <tr id="section-57">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-57">&#182;</a>               </div>               <p>do not trigger another PointerDown event if currently down, prevent chorded PointerDown events</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="k">if</span> <span class="p">(</span><span class="nx">wasAButtonDownAlready</span> <span class="o">&amp;&amp;</span> <span class="nx">_buttons</span> <span class="o">!==</span> <span class="nx">button</span><span class="p">)</span> <span class="p">{</span>
</pre></div>             </td>           </tr>                               <tr id="section-58">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-58">&#182;</a>               </div>               <p>per the Pointer Events spec, when the active buttons change it fires only a PointerMove event</p>             </td>             <td class="code">               <div class="highlight"><pre>
                    <span class="nx">triggerCustomEvent</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">&quot;pointermove&quot;</span><span class="p">,</span> <span class="nx">event</span><span class="p">);</span>
                    <span class="k">return</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="nx">triggerCustomEvent</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">&quot;pointerdown&quot;</span><span class="p">,</span> <span class="nx">event</span><span class="p">);</span>
            <span class="p">},</span>
            <span class="nx">add</span><span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">delegateSpecial</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">handleObj</span><span class="p">)</span> <span class="p">{</span>
</pre></div>             </td>           </tr>                               <tr id="section-59">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-59">&#182;</a>               </div>               <p>bind to touch events, some devices (chromebook) can send both touch and mouse events</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="k">if</span> <span class="p">(</span><span class="nx">support</span><span class="p">.</span><span class="nx">touch</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">addEvent</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">&quot;touchstart&quot;</span><span class="p">,</span> <span class="nx">handleObj</span><span class="p">.</span><span class="nx">selector</span><span class="p">,</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">special</span><span class="p">.</span><span class="nx">pointerdown</span><span class="p">.</span><span class="nx">touch</span><span class="p">);</span>
                <span class="p">}</span>

</pre></div>             </td>           </tr>                               <tr id="section-60">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-60">&#182;</a>               </div>               <p>bind to mouse events</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="nx">addEvent</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">&quot;mousedown&quot;</span><span class="p">,</span> <span class="nx">handleObj</span><span class="p">.</span><span class="nx">selector</span><span class="p">,</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">special</span><span class="p">.</span><span class="nx">pointerdown</span><span class="p">.</span><span class="nx">mouse</span><span class="p">);</span>

</pre></div>             </td>           </tr>                               <tr id="section-61">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-61">&#182;</a>               </div>               <p>ensure we also bind to "pointerup" to properly clear signals and fire click event on "touchend"</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="nx">handleObj</span><span class="p">.</span><span class="nx">pointerup</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">noop</span><span class="p">;</span>
                <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;pointerup&quot;</span><span class="p">,</span> <span class="nx">handleObj</span><span class="p">.</span><span class="nx">selector</span><span class="p">,</span> <span class="nx">handleObj</span><span class="p">.</span><span class="nx">pointerup</span><span class="p">);</span>
            <span class="p">}),</span>
            <span class="nx">remove</span><span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">delegateSpecial</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">handleObj</span><span class="p">)</span> <span class="p">{</span>
</pre></div>             </td>           </tr>                               <tr id="section-62">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-62">&#182;</a>               </div>               <p>unbind touch events</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="k">if</span> <span class="p">(</span><span class="nx">support</span><span class="p">.</span><span class="nx">touch</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">removeEvent</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">&quot;touchstart&quot;</span><span class="p">,</span> <span class="nx">handleObj</span><span class="p">.</span><span class="nx">selector</span><span class="p">,</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">special</span><span class="p">.</span><span class="nx">pointerdown</span><span class="p">.</span><span class="nx">touch</span><span class="p">);</span>
                <span class="p">}</span>

</pre></div>             </td>           </tr>                               <tr id="section-63">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-63">&#182;</a>               </div>               <p>unbind mouse events</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="nx">removeEvent</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">&quot;mousedown&quot;</span><span class="p">,</span> <span class="nx">handleObj</span><span class="p">.</span><span class="nx">selector</span><span class="p">,</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">special</span><span class="p">.</span><span class="nx">pointerdown</span><span class="p">.</span><span class="nx">mouse</span><span class="p">);</span>

</pre></div>             </td>           </tr>                               <tr id="section-64">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-64">&#182;</a>               </div>               <p>unbind the special "pointerup" we added for cleanup</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="k">if</span> <span class="p">(</span><span class="nx">handleObj</span><span class="p">.</span><span class="nx">pointerup</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">off</span><span class="p">(</span><span class="s2">&quot;pointerup&quot;</span><span class="p">,</span> <span class="nx">handleObj</span><span class="p">.</span><span class="nx">selector</span><span class="p">,</span> <span class="nx">handleObj</span><span class="p">.</span><span class="nx">pointerup</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">})</span>
        <span class="p">};</span>

        <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">special</span><span class="p">.</span><span class="nx">pointerup</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nx">touch</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
</pre></div>             </td>           </tr>                               <tr id="section-65">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-65">&#182;</a>               </div>               <p>prevent default to prevent the emulated "mouseup" event from being triggered</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>

</pre></div>             </td>           </tr>                               <tr id="section-66">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-66">&#182;</a>               </div>               <p>safety check, if _touching is null then we just had a mouse event and shouldn't
listen to touch events right now</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="k">if</span> <span class="p">(</span><span class="nx">_touching</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">return</span><span class="p">;</span>
                <span class="p">}</span>

</pre></div>             </td>           </tr>                               <tr id="section-67">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-67">&#182;</a>               </div>               <p>indicate that currently release the pointerdown lock</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="nx">_touching</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

                <span class="kd">var</span> <span class="nx">jEvent</span> <span class="o">=</span> <span class="nx">triggerCustomEvent</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">&quot;pointerup&quot;</span><span class="p">,</span> <span class="nx">event</span><span class="p">);</span>

</pre></div>             </td>           </tr>                               <tr id="section-68">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-68">&#182;</a>               </div>               <p>if we are preventing the next click event, then simply don't trigger one below</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="k">if</span> <span class="p">(</span><span class="nx">jEvent</span><span class="p">.</span><span class="nx">isClickPrevented</span><span class="p">())</span> <span class="p">{</span>
                    <span class="nx">$</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">).</span><span class="nx">off</span><span class="p">(</span><span class="s2">&quot;click&quot;</span><span class="p">,</span> <span class="nx">returnFalse</span><span class="p">);</span>
                    <span class="k">return</span><span class="p">;</span>
                <span class="p">}</span>

</pre></div>             </td>           </tr>                               <tr id="section-69">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-69">&#182;</a>               </div>               <p>on "touchend", calling prevent default prevents the "mouseup" and "click" event
however on native "mouseup" events preventing default does not cancel the "click" event
as per the pointer event spec on "pointerup" preventing default should not cancel the "click" event</p>

<p>we really do want to call this all the time, because if the function binded to this emulated
"poiunterup" triggered above called prevent default it would also prevent the click, which
would cause inconsistent behavior. To prevent the possibility of two click events though,
we want to call prevent default all the time (as we do above) and then force trigger the click here</p>

<p>we confirm that the user did not scroll, as touch events are very related to scrolling on
touch devices, it's possible we may mis-fire a click event on an <a> anchor tag causing
navigation even though this was a scroll attempt. Do the the browser's built in threshold
to prevent accidental scrolling we do not add a threshold here.</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span> <span class="o">&amp;&amp;</span> <span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">click</span> <span class="o">&amp;&amp;</span> <span class="nx">_startScrollOffset</span> <span class="o">===</span> <span class="nx">scrollY</span><span class="p">())</span> <span class="p">{</span>
                    <span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">click</span><span class="p">();</span>
                <span class="p">}</span>

</pre></div>             </td>           </tr>                               <tr id="section-70">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-70">&#182;</a>               </div>               <p>on iOS 5 there is no native click function on elements, therefore we need to let jQuery handle it (AR-16405)
on Android 4.1, you cannot prevent it from firing the native click event on touchend (GD-155106)</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span> <span class="o">&amp;&amp;</span> <span class="nx">_startScrollOffset</span> <span class="o">===</span> <span class="nx">scrollY</span><span class="p">())</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">clickTimer</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                        <span class="nx">$</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">).</span><span class="nx">click</span><span class="p">();</span>
                    <span class="p">},</span> <span class="mi">200</span><span class="p">);</span>

                    <span class="nx">$</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">).</span><span class="nx">one</span><span class="p">(</span><span class="s2">&quot;click&quot;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                        <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">clickTimer</span><span class="p">);</span>
                    <span class="p">});</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="nx">mouse</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
</pre></div>             </td>           </tr>                               <tr id="section-71">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-71">&#182;</a>               </div>               <p>if originally we had a TouchStart or we ended with a TouchEnd event, ignore this MouseUp</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="k">if</span> <span class="p">(</span><span class="nx">_touching</span> <span class="o">===</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">return</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="nx">_buttons</span> <span class="o">^=</span> <span class="nx">getStandardizedButtonsProperty</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>

</pre></div>             </td>           </tr>                               <tr id="section-72">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-72">&#182;</a>               </div>               <p>we only trigger a PointerUp event if no buttons are down, prevent chorded PointerDown events</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="k">if</span> <span class="p">(</span><span class="nx">_buttons</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">triggerCustomEvent</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">&quot;pointerup&quot;</span><span class="p">,</span> <span class="nx">event</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</pre></div>             </td>           </tr>                               <tr id="section-73">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-73">&#182;</a>               </div>               <p>per the Pointer Events spec, when the active buttons change it fires only a PointerMove event</p>             </td>             <td class="code">               <div class="highlight"><pre>
                    <span class="nx">triggerCustomEvent</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">&quot;pointermove&quot;</span><span class="p">,</span> <span class="nx">event</span><span class="p">);</span>
                <span class="p">}</span>

</pre></div>             </td>           </tr>                               <tr id="section-74">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-74">&#182;</a>               </div>               <p>Mouse Events spec shows that after a MouseUp it fires a MouseMove, which will trigger
the PointerMove needed to follow the Pointer Events spec which describes the same thing</p>             </td>             <td class="code">               <div class="highlight"><pre>
            <span class="p">},</span>
            <span class="nx">add</span><span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">delegateSpecial</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">handleObj</span><span class="p">)</span> <span class="p">{</span>
</pre></div>             </td>           </tr>                               <tr id="section-75">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-75">&#182;</a>               </div>               <p>bind to touch events, some devices (chromebook) can send both touch and mouse events</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="k">if</span> <span class="p">(</span><span class="nx">support</span><span class="p">.</span><span class="nx">touch</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">addEvent</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">&quot;touchend&quot;</span><span class="p">,</span> <span class="nx">handleObj</span><span class="p">.</span><span class="nx">selector</span><span class="p">,</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">special</span><span class="p">.</span><span class="nx">pointerup</span><span class="p">.</span><span class="nx">touch</span><span class="p">);</span>
                <span class="p">}</span>

</pre></div>             </td>           </tr>                               <tr id="section-76">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-76">&#182;</a>               </div>               <p>bind mouse events</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="nx">addEvent</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">&quot;mouseup&quot;</span><span class="p">,</span> <span class="nx">handleObj</span><span class="p">.</span><span class="nx">selector</span><span class="p">,</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">special</span><span class="p">.</span><span class="nx">pointerup</span><span class="p">.</span><span class="nx">mouse</span><span class="p">);</span>
            <span class="p">}),</span>
            <span class="nx">remove</span><span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">delegateSpecial</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">handleObj</span><span class="p">)</span> <span class="p">{</span>
</pre></div>             </td>           </tr>                               <tr id="section-77">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-77">&#182;</a>               </div>               <p>unbind touch events</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="k">if</span> <span class="p">(</span><span class="nx">support</span><span class="p">.</span><span class="nx">touch</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">removeEvent</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">&quot;touchend&quot;</span><span class="p">,</span> <span class="nx">handleObj</span><span class="p">.</span><span class="nx">selector</span><span class="p">,</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">special</span><span class="p">.</span><span class="nx">pointerup</span><span class="p">.</span><span class="nx">touch</span><span class="p">);</span>
                <span class="p">}</span>

</pre></div>             </td>           </tr>                               <tr id="section-78">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-78">&#182;</a>               </div>               <p>unbind mouse events</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="nx">removeEvent</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">&quot;mouseup&quot;</span><span class="p">,</span> <span class="nx">handleObj</span><span class="p">.</span><span class="nx">selector</span><span class="p">,</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">special</span><span class="p">.</span><span class="nx">pointerup</span><span class="p">.</span><span class="nx">mouse</span><span class="p">);</span>
            <span class="p">})</span>
        <span class="p">};</span>

        <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">special</span><span class="p">.</span><span class="nx">pointermove</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nx">touch</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">triggerCustomEvent</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">&quot;pointermove&quot;</span><span class="p">,</span> <span class="nx">event</span><span class="p">);</span>
            <span class="p">},</span>
            <span class="nx">mouse</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
</pre></div>             </td>           </tr>                               <tr id="section-79">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-79">&#182;</a>               </div>               <p>_touching will be true if they currently have their finger (touch only) down
because we cannot call preventDefault on the "touchmove" without preventing
scrolling on most things, we do this check to ensure we don't double fire
move events.</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="k">if</span> <span class="p">(</span><span class="nx">_touching</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">return</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="nx">triggerCustomEvent</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">&quot;pointermove&quot;</span><span class="p">,</span> <span class="nx">event</span><span class="p">);</span>
            <span class="p">},</span>
            <span class="nx">add</span><span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">delegateSpecial</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">handleObj</span><span class="p">)</span> <span class="p">{</span>
</pre></div>             </td>           </tr>                               <tr id="section-80">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-80">&#182;</a>               </div>               <p>bind to touch events, some devices (chromebook) can send both touch and mouse events</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="k">if</span> <span class="p">(</span><span class="nx">support</span><span class="p">.</span><span class="nx">touch</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">addEvent</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">&quot;touchmove&quot;</span><span class="p">,</span> <span class="nx">handleObj</span><span class="p">.</span><span class="nx">selector</span><span class="p">,</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">special</span><span class="p">.</span><span class="nx">pointermove</span><span class="p">.</span><span class="nx">touch</span><span class="p">);</span>
                <span class="p">}</span>

</pre></div>             </td>           </tr>                               <tr id="section-81">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-81">&#182;</a>               </div>               <p>bind mouse events</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="nx">addEvent</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">&quot;mousemove&quot;</span><span class="p">,</span> <span class="nx">handleObj</span><span class="p">.</span><span class="nx">selector</span><span class="p">,</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">special</span><span class="p">.</span><span class="nx">pointermove</span><span class="p">.</span><span class="nx">mouse</span><span class="p">);</span>
            <span class="p">}),</span>
            <span class="nx">remove</span><span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">delegateSpecial</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">handleObj</span><span class="p">)</span> <span class="p">{</span>
</pre></div>             </td>           </tr>                               <tr id="section-82">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-82">&#182;</a>               </div>               <p>unbind touch events</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="k">if</span> <span class="p">(</span><span class="nx">support</span><span class="p">.</span><span class="nx">touch</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">removeEvent</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">&quot;touchmove&quot;</span><span class="p">,</span> <span class="nx">handleObj</span><span class="p">.</span><span class="nx">selector</span><span class="p">,</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">special</span><span class="p">.</span><span class="nx">pointermove</span><span class="p">.</span><span class="nx">touch</span><span class="p">);</span>
                <span class="p">}</span>

</pre></div>             </td>           </tr>                               <tr id="section-83">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-83">&#182;</a>               </div>               <p>unbind mouse events</p>             </td>             <td class="code">               <div class="highlight"><pre>
                <span class="nx">removeEvent</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">&quot;mousemove&quot;</span><span class="p">,</span> <span class="nx">handleObj</span><span class="p">.</span><span class="nx">selector</span><span class="p">,</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">special</span><span class="p">.</span><span class="nx">pointermove</span><span class="p">.</span><span class="nx">mouse</span><span class="p">);</span>
            <span class="p">})</span>
        <span class="p">};</span>

        <span class="nx">jQuery</span><span class="p">.</span><span class="nx">each</span><span class="p">({</span>
            <span class="nx">pointerover</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">mouse</span><span class="o">:</span> <span class="s2">&quot;mouseover&quot;</span>
            <span class="p">},</span>
            <span class="nx">pointerout</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">mouse</span><span class="o">:</span> <span class="s2">&quot;mouseout&quot;</span>
            <span class="p">},</span>
            <span class="nx">pointercancel</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">touch</span><span class="o">:</span> <span class="s2">&quot;touchcancel&quot;</span>
            <span class="p">}</span>
        <span class="p">},</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">pointerEventType</span><span class="p">,</span> <span class="nx">natives</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">function</span> <span class="nx">onTouch</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">triggerCustomEvent</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">pointerEventType</span><span class="p">,</span> <span class="nx">event</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="kd">function</span> <span class="nx">onMouse</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">triggerCustomEvent</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">pointerEventType</span><span class="p">,</span> <span class="nx">event</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">special</span><span class="p">[</span><span class="nx">pointerEventType</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="nx">setup</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">support</span><span class="p">.</span><span class="nx">touch</span> <span class="o">&amp;&amp;</span> <span class="nx">natives</span><span class="p">.</span><span class="nx">touch</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">addEvent</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">natives</span><span class="p">.</span><span class="nx">touch</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">onTouch</span><span class="p">);</span>
                    <span class="p">}</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">natives</span><span class="p">.</span><span class="nx">mouse</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">addEvent</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">natives</span><span class="p">.</span><span class="nx">mouse</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">onMouse</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">},</span>
                <span class="nx">teardown</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">support</span><span class="p">.</span><span class="nx">touch</span> <span class="o">&amp;&amp;</span> <span class="nx">natives</span><span class="p">.</span><span class="nx">touch</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">removeEvent</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">natives</span><span class="p">.</span><span class="nx">touch</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">onTouch</span><span class="p">);</span>
                    <span class="p">}</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">natives</span><span class="p">.</span><span class="nx">mouse</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">removeEvent</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">natives</span><span class="p">.</span><span class="nx">mouse</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">onMouse</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">};</span>
        <span class="p">});</span>
    <span class="p">}</span>

</pre></div>             </td>           </tr>                               <tr id="section-84">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-84">&#182;</a>               </div>               <p>for IE10 specific, we proxy though events so we do not need to deal
with the various names or renaming of events.</p>             </td>             <td class="code">               <div class="highlight"><pre>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">msPointerEnabled</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">pointerEnabled</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">special</span><span class="p">,</span> <span class="p">{</span>
            <span class="nx">pointerdown</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">delegateType</span><span class="o">:</span> <span class="s2">&quot;MSPointerDown&quot;</span><span class="p">,</span>
                <span class="nx">bindType</span><span class="o">:</span> <span class="s2">&quot;MSPointerDown&quot;</span>
            <span class="p">},</span>
            <span class="nx">pointerup</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">delegateType</span><span class="o">:</span> <span class="s2">&quot;MSPointerUp&quot;</span><span class="p">,</span>
                <span class="nx">bindType</span><span class="o">:</span> <span class="s2">&quot;MSPointerUp&quot;</span>
            <span class="p">},</span>
            <span class="nx">pointermove</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">delegateType</span><span class="o">:</span> <span class="s2">&quot;MSPointerMove&quot;</span><span class="p">,</span>
                <span class="nx">bindType</span><span class="o">:</span> <span class="s2">&quot;MSPointerMove&quot;</span>
            <span class="p">},</span>
            <span class="nx">pointerover</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">delegateType</span><span class="o">:</span> <span class="s2">&quot;MSPointerOver&quot;</span><span class="p">,</span>
                <span class="nx">bindType</span><span class="o">:</span> <span class="s2">&quot;MSPointerOver&quot;</span>
            <span class="p">},</span>
            <span class="nx">pointerout</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">delegateType</span><span class="o">:</span> <span class="s2">&quot;MSPointerOut&quot;</span><span class="p">,</span>
                <span class="nx">bindType</span><span class="o">:</span> <span class="s2">&quot;MSPointerOut&quot;</span>
            <span class="p">},</span>
            <span class="nx">pointercancel</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">delegateType</span><span class="o">:</span> <span class="s2">&quot;MSPointerCancel&quot;</span><span class="p">,</span>
                <span class="nx">bindType</span><span class="o">:</span> <span class="s2">&quot;MSPointerCancel&quot;</span>
            <span class="p">}</span>
        <span class="p">});</span>

        <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">fixHooks</span><span class="p">,</span> <span class="p">{</span>
            <span class="nx">MSPointerDown</span><span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">pointerHooks</span><span class="p">,</span>
            <span class="nx">MSPointerUp</span><span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">pointerHooks</span><span class="p">,</span>
            <span class="nx">MSPointerMove</span><span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">pointerHooks</span><span class="p">,</span>
            <span class="nx">MSPointerOver</span><span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">pointerHooks</span><span class="p">,</span>
            <span class="nx">MSPointerOut</span><span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">pointerHooks</span><span class="p">,</span>
            <span class="nx">MSPointerCancel</span><span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">pointerHooks</span>
        <span class="p">});</span>
    <span class="p">}</span>

<span class="p">})(</span><span class="nx">jQuery</span><span class="p">,</span> <span class="nb">window</span><span class="p">,</span> <span class="nb">document</span><span class="p">);</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 